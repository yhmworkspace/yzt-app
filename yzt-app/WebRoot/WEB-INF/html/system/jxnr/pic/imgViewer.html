<!DOCTYPE html>
<html >
  <head>
  <base href="${BASE_PATH}">
  </head>
  <body>
<div id='ddd'  class="Noprint"   align="left">   

		  <OBJECT   id="WebBrowser"   height="0"   width="0"   classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2">     
  			</OBJECT>  
#--		  <hr   align="center"   width="70%"   noShade   SIZE="1">    
	   <input   onclick="javascript:originalImage()"   type="button"   value="实际大小"> 
--#
 
  <input   onclick="javascript:featImage()"   type="button"   value="最合适大小"> 
  <input   onclick="javascript:add()"   type="button"   value="放大图片">
  <input   onclick="javascript:sub()"   type="button"   value="缩小图片">  
     
</div>
		
		<IMG id='oImage' onmousewheel='return Picture()' src='system/choicenesscontent/pic/display/${choicenesscontentId}/${picId}' onload="javascript:initImage(this);">

<script type="text/javascript">
	var count = 10;
	var vImgW=0;
    var vImgH=0;
    var image=new Image(); 
    image.src=oImage.src; 
    vImgW= image.width;
    vImgH=image.height;
	function Picture(){
		count = Counting(count);Resize(count); return false;}
	function Counting(count){
		if (event.wheelDelta >= 120) 
			count++;
		else if (event.wheelDelta <= -120){
			count--;
		}
		if(count<1) count=1;
		if(count>30)count=30;
		return count;
	}
	function add(){
			count++;
		if(count<1) count=1;
		if(count>30)count=30;
		Resize(count);
	}
	function sub(){
			count--;
		if(count<1) count=1;
		if(count>30)count=30;
		Resize(count);
	}
	function Resize(count){
	oImage.style.zoom = count + '0%';
	}

function originalImage(){
	count=10;
	Resize(10);
	oImage.width=vImgW;
	oImage.height=vImgH;
}
function featImage(){
	count=10;
	Resize(10);
	DrawImage(oImage,document.body.clientWidth,document.body.clientHeight-ddd.scrollHeight);
}	
function initImage(img){
	
	DrawImage(img,document.body.clientWidth,document.body.clientHeight-ddd.scrollHeight);
}

var flag=false;    
function DrawImage(ImgD,maxwidth,maxheight){  
   var image=new Image(); 
   image.src=ImgD.src;  
   if(image.width>0 && image.height>0){  
    flag=true;  
    if(image.width/image.height>=maxwidth/maxheight){  
     if(image.width>maxwidth){    
     ImgD.width=maxwidth;  
     ImgD.height=(image.height*maxwidth)/image.width;  
     }else{  
     ImgD.width=image.width;    
     ImgD.height=image.height;  
     }  
     }  
    else{  
     if(image.height>maxheight){    
     ImgD.height=maxheight;  
     ImgD.width=(image.width*maxheight)/image.height;       
     }else{  
     ImgD.width=image.width;    
     ImgD.height=image.height;  
     }  
     }  
    }  
   }

	
</script>
	</body>
</html>